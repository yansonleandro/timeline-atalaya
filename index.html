<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline Compacto con Revelación a la Derecha</title>
    <style>
        /* --- VARIABLES Y ESTILOS GLOBALES --- */
        :root {
            --ucla-blue: #005599;
            --ucla-gold: #ffb81c; /* Color de acento */
            --line-color: #ccc;
            --background-color: #f8f8f8;
            --line-position: 150px; /* Ancho de la columna izquierda y posición de la línea */
            --content-width: 1200px; /* Ancho máximo del contenido */
            --event-spacing: 0px; /* Eliminado el espaciado entre tarjetas */
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            scroll-behavior: smooth;
        }

        /* Ocultar la barra de desplazamiento */
        body::-webkit-scrollbar { display: none; }
        body { -ms-overflow-style: none; scrollbar-width: none; }

        /* --- COLUMNA DE FECHAS FIJA A LA IZQUIERDA --- */
        .dates-column {
            position: fixed; /* Vuelve a estar fijo en la pantalla */
            top: 0;
            left: 0;
            width: var(--line-position); /* Ancho de la columna */
            height: 100vh; /* Ocupa el 100% de la altura de la ventana */
            z-index: 10;
            padding-top: 100px; /* Espacio para la barra de navegación */
            box-sizing: border-box;
        }

        /* Contenedor para los marcadores de fecha */
        .date-markers-container {
            position: relative;
            height: 100%; /* Ocupa toda la altura disponible en la columna */
            display: flex;
           flex-direction: column;
            align-items: center;
            overflow-y: auto; /* Permite scroll si los marcadores no caben */
            padding-top: 50px; /* Espacio superior dentro del scroll */
            padding-bottom: 50px; /* Espacio inferior dentro del scroll */
            box-sizing: border-box; /* Para que el padding no aumente el tamaño */
            justify-content: flex-start; /* Alinea los items al inicio */
        }

        /* Ocultar la barra de scroll en la columna de fechas */
        .date-markers-container::-webkit-scrollbar { display: none; }
        .date-markers-container { -ms-overflow-style: none; scrollbar-width: none; }


        /* Línea vertical dentro de la columna de fechas */
        .dates-column .vertical-line {
            position: absolute;
            top: 0; bottom: 0; left: 50%;
            width: 4px;
            background: var(--line-color);
            transform: translateX(-50%);
            z-index: 2; /* Detrás del punto, pero sobre el fondo */
        }
        
        /* --- BARRA DE NAVEGACIÓN SUPERIOR FIJA --- */
        .top-nav {
            position: fixed;
            top: 0;
            left: 50%; /* Centrado horizontal */
            transform: translateX(-50%); /* Ajuste fino para centrado perfecto */
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            border-radius: 0 0 12px 12px; /* Bordes redondeados inferiores */
            padding: 0 20px;
            box-sizing: border-box;
        }
        .nav-links {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-link a {
            display: block;
            padding: 15px 20px;
            text-decoration: none;
            color: var(--ucla-blue);
            font-weight: bold;
            transition: background-color 0.3s, color 0.3s;
            border-bottom: 3px solid transparent;
        }
        .nav-link.is-active a, .nav-link a:hover {
            color: var(--ucla-gold);
            border-bottom-color: var(--ucla-gold);
        }
        
        /* --- CONTENEDOR PRINCIPAL --- */
        .timeline-container {
            margin-left: var(--line-position); /* Empuja el contenido a la derecha de la columna de fechas */
            padding-top: 120px; /* Espacio para la barra de navegación */
            /* padding-bottom: 50vh; -> Se eliminará y se gestionará con JS */
            position: relative;
            width: calc(100% - var(--line-position));
        }
        
        /* --- EVENTO PRINCIPAL (Ahora compacto y continuo) --- */
        .timeline-event {
            display: flex;
            align-items: center; 
            position: relative;
            z-index: 5; 
            padding: 0 40px;
            margin-bottom: var(--event-spacing); /* Volvemos a usar margen para separar eventos */
            min-height: 200px; /* Altura mínima para que el observer funcione bien */
        }        
        .timeline-event:last-child {
            margin-bottom: 0; /* El último elemento no necesita margen inferior */
            min-height: auto; /* Anula la altura mínima para evitar espacio extra al final */
        }

        /* --- MARCADOR DE FECHA (Píldora en la columna izquierda) --- */
        .event-label-wrapper {
            position: relative;
            display: flex; /* Usa flexbox para alinear la fecha y la estrella */
            flex-direction: column; /* Apila el año y la estrella verticalmente */
            align-items: center; /* Centra verticalmente la fecha y la estrella entre sí */
            transform-origin: center center; /* Origen de la transformación para la escala */
            transition: transform 0.3s ease-in-out, color 0.3s ease-in-out;
            pointer-events: auto; /* Habilita eventos de puntero para este bloque */
            color: var(--ucla-blue); /* Color por defecto para el bloque */
            cursor: pointer; /* Indica que todo el bloque es clickeable */
            background-color: var(--background-color); /* Fondo para que no se superponga la línea */
            padding: 2px 8px; /* Espaciado interno */
            border-radius: 20px; /* Bordes redondeados para efecto "píldora" */
             margin-bottom: 50px; /* Espacio entre marcadores de fecha */
            z-index: 3; /* Sobre la línea vertical */
        }

        .event-point {
            position: relative; /* Fluye dentro del event-label-wrapper */
            font-size: 2.2em; /* Tamaño de la estrella */
            color: inherit; /* Hereda el color del event-label-wrapper */
            padding-left: 0; /* Espaciado horizontal ya no es necesario */
            pointer-events: auto; /* Habilita eventos de puntero para el punto */
        }

        .event-point:hover {
            /* El hover ahora solo cambia el color, la escala la maneja el padre activo */
            color: var(--ucla-gold); 
        }

        .event-year-label {
            position: relative; /* Fluye dentro del event-label-wrapper */
            font-size: 1.6em; /* Mismo tamaño que la estrella para alineación perfecta */
            font-weight: bold;
            color: inherit; /* Hereda el color del event-label-wrapper */
            white-space: nowrap; /* Evita que el año se rompa en varias líneas */
            pointer-events: auto; /* Habilita eventos de puntero para la etiqueta */
        }
        
        /* --- TARJETA DE CONTENIDO (Expansión y Aparición a la Derecha) --- */
        .event-content-wrapper {
            width: calc(100vw - var(--line-position) - 80px);
            max-width: var(--content-width);
            padding: 25px; /* Añadido padding para que el contenido no toque los bordes */
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            
            transform-origin: left center;
            /* ESTADO INICIAL (Colapsado/Minimizado) */
            opacity: 0;
            transform: scale(0.7);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out; /* Animación más suave */
        }
        
        /* ESTADO ACTIVO (Expansión al centrarse en la vista) */
        .timeline-event.is-active .event-content-wrapper {
            opacity: 1;
            transform: scale(1);
        }

        /* El marcador de fecha también se activa */
        .event-label-wrapper.is-active {
            color: var(--ucla-gold);
            transform: scale(1.2);
        }

        .event-content-wrapper h2 {
            color: var(--ucla-blue); /* Mantener el color del título */
            border-bottom: 2px solid var(--ucla-gold);
            padding-bottom: 10px;
            margin-top: 0;
            font-size: 1.8em;
        }
        
        /* Estilo de la imagen */
        .event-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        /* --- SCROLL SNAP HORIZONTAL INTERNO (Retenido) --- */
        .horizontal-slider {
            display: flex;
            overflow-x: scroll;
            scroll-snap-type: x mandatory; 
            -webkit-overflow-scrolling: touch;
            padding-bottom: 10px; 
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .horizontal-slider::-webkit-scrollbar { display: none; }
        .slider-item {
            flex: 0 0 100%;
            width: 100%;
            scroll-snap-align: center;
            box-sizing: border-box;
        }
        
        /* Estilos refinados para el contenido del slider */
        .slider-item h4 {
            font-size: 1.1em;
            color: #555;
            margin-top: 0;
            margin-bottom: 8px;
        }
        .slider-item p {
            font-size: 1em;
            color: #666;
            line-height: 1.6;
        }

        /* --- MEDIA QUERIES (Móviles) --- */
        @media screen and (max-width: 900px) {
            :root {
                --line-position: 60px; /* Ancho reducido para la columna de fechas */
            }

            /* Ocultar solo la barra de navegación superior */
            .top-nav {
                display: none;
            }

            /* Ajustar el contenedor principal para que deje espacio a la columna de fechas */
            .timeline-container {
                margin-left: var(--line-position);
                width: calc(100% - var(--line-position));
                padding-top: 20px; /* Menos espacio superior al no haber nav */
            }

            /* Reducir padding y tamaños de fuente para que quepan */
            .timeline-event {
                padding: 0 15px;
            }
            .event-year-label {
                font-size: 1em;
            }
            .event-content-wrapper {
                padding: 15px;
            }
        }
    </style>
</head>
<body>

    <nav class="top-nav">
        <ul class="nav-links" id="navLinks"></ul>
    </nav>
    
    <div class="dates-column">
        <div class="vertical-line"></div>
        <div class="date-markers-container" id="dateMarkersContainer"></div>
    </div>

    <div class="timeline-container" id="timelineContainer">
        </div>

    <script>
        // 1. DATOS: Mantenemos los datos anteriores.
        const timelineData = [
            {
                year: '2025',
                mainTitle: 'Futuro Sostenible y Expansión Global',
                imageURL: 'https://picsum.photos/650/250?random=1', 
                items: [
                    { slideTitle: 'Nuevos Campus', content: 'Inauguración de nuevos campus en Asia y Europa, expandiendo nuestra presencia global.' },
                ]
            },
            {
                year: '2025', // Año repetido
                mainTitle: 'Alianza Estratégica Tecnológica',
                imageURL: 'https://picsum.photos/650/250?random=2', 
                items: [
                    { slideTitle: 'Colaboración con Tech Corp', content: 'Firma de un acuerdo histórico para desarrollar laboratorios de inteligencia artificial de última generación.' },
                ]
            },
            {
                year: '2023',
                mainTitle: 'Premio Nobel de Medicina',
                imageURL: 'https://picsum.photos/650/250?random=3', 
                items: [
                    { slideTitle: 'Investigación Revolucionaria', content: 'Un equipo de la universidad es galardonado con el Premio Nobel por su trabajo pionero en terapia génica.' },
                ]
            },
            {
                year: '2021',
                mainTitle: 'Lanzamiento de Plataforma Híbrida',
                imageURL: 'https://picsum.photos/650/250?random=4', 
                items: [
                    { slideTitle: 'Modelo "Flex-Learn"', content: 'Implementación de un nuevo modelo de aprendizaje que combina clases presenciales y en línea de forma fluida.' },
                ]
            },
             {
                year: '2019',
                mainTitle: 'Centenario de la Universidad',
                imageURL: 'https://picsum.photos/650/250?random=5', 
                items: [
                    { slideTitle: 'Celebraciones y Eventos', content: 'Un año completo de celebraciones para conmemorar los 100 años de historia, impacto y excelencia académica.' }
                ]
            },
            {
                year: '2018',
                mainTitle: 'Inauguración del Centro de Artes',
                imageURL: 'https://picsum.photos/650/250?random=6', 
                items: [
                    { slideTitle: 'Un Nuevo Escenario', content: 'Se abre un moderno centro para teatro, danza y música, fomentando la creatividad en el campus.' }
                ]
            },
            {
                year: '2017',
                mainTitle: 'Campeonato Nacional Deportivo',
                imageURL: 'https://picsum.photos/650/250?random=7', 
                items: [
                    { slideTitle: 'Victoria Histórica', content: 'El equipo de baloncesto gana el campeonato nacional, un hito para el deporte universitario.' }
                ]
            },
            {
                year: '2017', // Año repetido
                mainTitle: 'Programa de Becas Globales',
                imageURL: 'https://picsum.photos/650/250?random=8', 
                items: [
                    { slideTitle: 'Acceso a la Educación', content: 'Lanzamiento de un ambicioso programa de becas para estudiantes internacionales de bajos recursos.' }
                ]
            },
            {
                year: '1997',
                mainTitle: 'Lanzamiento del Primer Sitio Web',
                imageURL: 'https://picsum.photos/650/250?random=9', 
                items: [
                    { slideTitle: 'Presencia Digital', content: 'La universidad estrena su primer sitio web oficial, abriendo un nuevo canal de comunicación con el mundo.' }
                ]
            }
        ];

        // 2. LÓGICA DE RENDERIZADO (Sin cambios)
        function renderTimeline() {
            const container = document.getElementById('timelineContainer');
            const navLinksContainer = document.getElementById('navLinks');
            const dateMarkersContainer = document.getElementById('dateMarkersContainer');

            timelineData.forEach((event, index) => {
                const uniqueId = `event-${event.year}-${index}`; // Crear un ID único
                // --- 1. Crear la tarjeta de contenido en la columna derecha ---
                const eventDiv = document.createElement('div');
                eventDiv.classList.add('timeline-event');
                eventDiv.id = uniqueId;
                const wrapperDiv = document.createElement('div');
                wrapperDiv.classList.add('event-content-wrapper');
                
                wrapperDiv.innerHTML = `
                    <img src="${event.imageURL}" alt="${event.mainTitle}" class="event-image">
                    <h2>${event.mainTitle}</h2>
                `;
                const sliderContainer = document.createElement('div');
                sliderContainer.classList.add('horizontal-slider');
                event.items.forEach(item => {
                    const sliderItem = document.createElement('div');
                    sliderItem.classList.add('slider-item');
                    sliderItem.innerHTML = `
                        <h4>${item.slideTitle}</h4>
                        <p>${item.content}</p>
                    `;
                    sliderContainer.appendChild(sliderItem);
                });
                wrapperDiv.appendChild(sliderContainer);

                eventDiv.appendChild(wrapperDiv);
                container.appendChild(eventDiv);

                // --- 2. Crear el marcador de fecha en la columna izquierda ---
                const labelWrapperDiv = document.createElement('div');
                labelWrapperDiv.classList.add('event-label-wrapper');
                labelWrapperDiv.dataset.targetId = uniqueId; // Conectar con el evento
                labelWrapperDiv.dataset.eventYear = uniqueId;

                const yearLabelDiv = document.createElement('div');
                yearLabelDiv.classList.add('event-year-label');
                yearLabelDiv.textContent = event.year;

                const pointDiv = document.createElement('div');
                pointDiv.classList.add('event-point');
                pointDiv.innerHTML = '&#9733;';

                labelWrapperDiv.appendChild(pointDiv); // Estrella primero
                labelWrapperDiv.appendChild(yearLabelDiv); // Luego la fecha
                dateMarkersContainer.appendChild(labelWrapperDiv);

                // Crear y añadir el enlace a la barra de navegación
                const navLinkLi = document.createElement('li');
                navLinkLi.classList.add('nav-link');
                navLinkLi.dataset.eventYear = uniqueId; // Para identificarlo en el observer
                navLinkLi.innerHTML = `<a href="#${uniqueId}">${event.year}</a>`;
                navLinksContainer.appendChild(navLinkLi);
            });

            // Añadir funcionalidad de click a los puntos del timeline
            setupMarkerClickScrolling();

            // Configurar observador y clics después de renderizar todo
            setupIntersectionObserver();
            setupNavClickScrolling();
        }

        // Función de scroll suave personalizada para un efecto más armónico
        function smoothScrollTo(container, element, duration = 800) {
            const containerRect = container.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
            const startPosition = container.scrollTop;
            // Calcula la posición de scroll necesaria para centrar el elemento en el contenedor
            const targetPosition = startPosition + elementRect.top - containerRect.top - (containerRect.height / 2) + (elementRect.height / 2);
            
            let startTime = null;

            // Función de easing (aceleración y desaceleración)
            const easeInOutQuad = t => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;

            function animation(currentTime) {
                if (startTime === null) startTime = currentTime;
                const timeElapsed = currentTime - startTime;
                const progress = Math.min(timeElapsed / duration, 1);
                const easedProgress = easeInOutQuad(progress);

                container.scrollTop = startPosition + (targetPosition - startPosition) * easedProgress;

                if (timeElapsed < duration) {
                    requestAnimationFrame(animation);
                }
            }
            requestAnimationFrame(animation);
        }
        // 3. LÓGICA DE ANIMACIÓN Y TRANSICIÓN
        function setupIntersectionObserver() {
            const events = document.querySelectorAll('.timeline-event');
            
            const options = {
                root: null, 
                rootMargin: '-50% 0px -50% 0px', /* Margen para detectar el centro del viewport */
                threshold: 0 /* Activa en cuanto el elemento toca el margen */
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // Desactivar todos los demás para asegurar que solo uno esté activo
                        document.querySelectorAll('.is-active').forEach(el => el.classList.remove('is-active'));

                        const uniqueId = entry.target.id;
                        const navLink = document.querySelector(`.nav-link[data-event-year="${uniqueId}"]`);
                        const dateMarker = document.querySelector(`.event-label-wrapper[data-event-year="${uniqueId}"]`);

                        // Activar el evento, el link de nav y el marcador de fecha
                        entry.target.classList.add('is-active');
                        if (navLink) navLink.classList.add('is-active');
                        
                        if (dateMarker) {
                            const dateContainer = document.getElementById('dateMarkersContainer');
                            dateMarker.classList.add('is-active');
                            smoothScrollTo(dateContainer, dateMarker);
                        }
                    } else { 
                        // Opcional: si quieres que se desactiven al salir de la vista central
                        // entry.target.classList.remove('is-active');
                        // if (navLink) navLink.classList.remove('is-active');
                        // if (dateMarker) dateMarker.classList.remove('is-active');
                    }
                });
            }, options);

            events.forEach(event => {
                observer.observe(event);
            });
        }

        // 4. LÓGICA PARA SCROLL SUAVE AL HACER CLIC EN LA NAVEGACIÓN
        function setupNavClickScrolling() {
            const navLinks = document.querySelectorAll('.nav-link a');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault(); // Prevenir el salto brusco del ancla
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                });
            });
        }

        // 5. LÓGICA PARA SCROLL SUAVE AL HACER CLIC EN EL MARCADOR DE FECHA
        function setupMarkerClickScrolling() {
            const markers = document.querySelectorAll('.event-label-wrapper');
            markers.forEach(marker => {
                marker.addEventListener('click', function(e) {
                    const targetId = this.dataset.targetId;
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        // Usar scrollIntoView para navegar suavemente
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                });
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Deshabilitar la restauración de scroll del navegador para que siempre empiece arriba.
            if ('scrollRestoration' in history) {
                history.scrollRestoration = 'manual';
            }
            // Forzar el scroll al inicio de la página.
            window.scrollTo(0, 0);
            // Ahora, renderizar el timeline.
            renderTimeline();

            // Activar el primer evento por defecto al cargar la página
            const firstEvent = document.querySelector('.timeline-event');
            if (firstEvent) {
                const uniqueId = firstEvent.id;
                const firstNavLink = document.querySelector(`.nav-link[data-event-year="${uniqueId}"]`);
                const firstMarker = document.querySelector(`.event-label-wrapper[data-event-year="${uniqueId}"]`);
                firstEvent.classList.add('is-active');
                if (firstNavLink) firstNavLink.classList.add('is-active');
                if (firstMarker) firstMarker.classList.add('is-active');
            }
        });

    </script>

</body>
</html>